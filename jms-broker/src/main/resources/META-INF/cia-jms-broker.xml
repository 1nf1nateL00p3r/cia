<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

   <bean id="securityManager" class="org.apache.activemq.artemis.spi.core.security.ActiveMQJAASSecurityManager">
      <constructor-arg value="org.apache.activemq.artemis.spi.core.security.jaas.InVMLoginModule"/>
      <constructor-arg>
         <bean class="org.apache.activemq.artemis.core.config.impl.SecurityConfiguration">
            <constructor-arg name="users">
               <map>
                  <entry key="guest" value="guest"/>
               </map>
            </constructor-arg>
            <constructor-arg name="roles">
               <map>
                  <entry key="guest">
                     <list>
                        <value>guest</value>
                     </list>
                  </entry>
               </map>
            </constructor-arg>
            <property name="DefaultUser" value="guest"/>
         </bean>
      </constructor-arg>
   </bean>

   <bean id="EmbeddedActiveMQ" class="org.apache.activemq.artemis.core.server.embedded.EmbeddedActiveMQ" init-method="start" destroy-method="stop">
       <property name="SecurityManager" ref="securityManager"/>
   </bean>

   <bean id="jmsFactory" class="org.apache.activemq.artemis.jms.client.ActiveMQXAConnectionFactory">
      <constructor-arg value="vm://0"/>
   </bean>

	<bean name="connectionFactory" class="org.jboss.narayana.jta.jms.ConnectionFactoryProxy">
		<constructor-arg ref="jmsFactory" />
		<constructor-arg ref="transactionHelper" />
	</bean>

	<bean name="senderConnectionFactory" class="org.jboss.narayana.jta.jms.ConnectionFactoryProxy">
		<constructor-arg ref="jmsFactory" />
		<constructor-arg ref="transactionHelper" />
	</bean>
	
	<bean name="transactionHelper" class="org.jboss.narayana.jta.jms.TransactionHelperImpl">
		<constructor-arg ref="transactionManagerImpl"/>
	</bean> 	
   
</beans>
